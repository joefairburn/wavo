---
import { mainNav } from "../config/navigation";
import { siteConfig } from "../config/site";

interface Props {
  currentPath?: string;
}

const { currentPath = "" } = Astro.props;
---

<header class="h-16 flex items-center justify-between border-b border-border-dark bg-background-dark px-6 sticky top-0 z-50">
  <div class="flex items-center gap-8">
    <!-- Logo -->
    <a href="/" class="flex items-center gap-3 text-white cursor-pointer hover:opacity-90 transition-opacity">
      <div class="size-8 rounded bg-gradient-to-br from-primary to-orange-700 flex items-center justify-center text-white">
        <span class="material-symbols-outlined text-[20px]">graphic_eq</span>
      </div>
      <h2 class="text-white text-xl font-bold tracking-tight">Wavo</h2>
    </a>
  </div>

  <div class="flex items-center gap-6">
    <!-- Navigation (desktop) -->
    <nav class="hidden md:flex items-center gap-6">
      {
        mainNav.map((item) => {
          const isActive = currentPath === item.href || currentPath.startsWith(item.href + "/");
          return (
            <a
              href={item.href}
              class:list={[
                "text-sm font-medium transition-colors",
                isActive ? "text-white" : "text-muted hover:text-white",
              ]}
            >
              {item.label}
            </a>
          );
        })
      }
    </nav>

    <div class="h-4 w-px bg-border-dark hidden md:block"></div>

    <div class="flex items-center gap-4">
      <!-- GitHub Icon -->
      <a
        href={siteConfig.github}
        target="_blank"
        rel="noopener noreferrer"
        aria-label="GitHub"
        class="text-muted hover:text-white transition-colors"
      >
        <svg aria-hidden="true" class="h-5 w-5 fill-current" viewBox="0 0 24 24">
          <title>GitHub</title>
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M12 2C6.477 2 2 6.463 2 11.97c0 4.404 2.865 8.14 6.839 9.458.5.092.682-.216.682-.48 0-.236-.008-.864-.013-1.695-2.782.602-3.369-1.337-3.369-1.337-.454-1.151-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48 3.97-1.32 6.833-5.054 6.833-9.458C22 6.463 17.522 2 12 2z"
          />
        </svg>
      </a>

      <!-- Version Badge -->
      <span class="flex items-center justify-center rounded bg-primary/20 border border-primary/30 px-2 py-0.5 text-xs font-bold text-primary tracking-wide">
        v{siteConfig.version}
      </span>

      <!-- Mobile Menu Toggle -->
      <button
        type="button"
        class="md:hidden text-white p-2"
        id="mobile-menu-toggle"
        aria-label="Toggle menu"
        aria-expanded="false"
        aria-controls="mobile-menu"
      >
        <span class="material-symbols-outlined text-2xl" id="menu-icon">menu</span>
      </button>
    </div>
  </div>
</header>

<!-- Mobile Menu -->
<nav
  id="mobile-menu"
  class="fixed inset-x-0 top-16 z-40 bg-background-dark border-b border-border-dark transform -translate-y-full transition-transform duration-200 ease-out md:hidden"
  aria-hidden="true"
>
  <div class="px-6 py-4 space-y-2">
    {
      mainNav.map((item) => {
        const isActive = currentPath === item.href || currentPath.startsWith(item.href + "/");
        return (
          <a
            href={item.href}
            class:list={[
              "block py-3 px-4 text-sm font-medium transition-colors rounded",
              isActive ? "text-white bg-primary/10" : "text-muted hover:text-white hover:bg-surface",
            ]}
          >
            {item.label}
          </a>
        );
      })
    }
    <div class="pt-4 mt-4 border-t border-border-dark">
      <a
        href={siteConfig.github}
        target="_blank"
        rel="noopener noreferrer"
        class="flex items-center gap-3 py-3 px-4 text-sm font-medium text-muted hover:text-white transition-colors rounded hover:bg-surface"
      >
        <svg aria-hidden="true" class="h-5 w-5 fill-current" viewBox="0 0 24 24">
          <title>GitHub</title>
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M12 2C6.477 2 2 6.463 2 11.97c0 4.404 2.865 8.14 6.839 9.458.5.092.682-.216.682-.48 0-.236-.008-.864-.013-1.695-2.782.602-3.369-1.337-3.369-1.337-.454-1.151-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48 3.97-1.32 6.833-5.054 6.833-9.458C22 6.463 17.522 2 12 2z"
          />
        </svg>
        View on GitHub
      </a>
    </div>
  </div>
</nav>

<script>
  const toggle = document.getElementById("mobile-menu-toggle");
  const menu = document.getElementById("mobile-menu");
  const menuIcon = document.getElementById("menu-icon");

  if (toggle && menu && menuIcon) {
    toggle.addEventListener("click", () => {
      const isExpanded = toggle.getAttribute("aria-expanded") === "true";
      toggle.setAttribute("aria-expanded", String(!isExpanded));
      menu.setAttribute("aria-hidden", String(isExpanded));

      if (isExpanded) {
        menu.classList.add("-translate-y-full");
        menu.classList.remove("translate-y-0");
        menuIcon.textContent = "menu";
      } else {
        menu.classList.remove("-translate-y-full");
        menu.classList.add("translate-y-0");
        menuIcon.textContent = "close";
      }
    });
  }
</script>
